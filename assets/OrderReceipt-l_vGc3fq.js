import{j as s}from"./ui-CQezrcTP.js";import{g as e,u as a,r as t}from"./router-BoIKchTz.js";import{B as i,f as d,g as n,q as l,w as r,i as c}from"./index-fn-PujCN.js";import{C as m,b as x,d as o,a as h}from"./card-BbwgIik3.js";import{z as j,B as p}from"./icons-DJh_lpvr.js";import"./vendor-Cfs_Iq82.js";import"./utils-BLjywKrO.js";const f=()=>{var f,u,N,v;const{id:y}=e(),g=a(),[b,w]=t.useState(null),[S,A]=t.useState(!0),[F,I]=t.useState(!1);t.useEffect(()=>{if(!y)return;const s=localStorage.getItem("currentUserId");if(s){const a=localStorage.getItem(`orders_${s}`);if(a)try{const s=JSON.parse(a).find(s=>s.id===y);s&&(w(s),A(!1),I(!0))}catch(e){}}},[y]),t.useEffect(()=>{if(!y)return;let s=!0;return(async()=>{Date.now();try{const e=d(n,"orders"),a=l(e,r("id","==",y)),t=await c(a);if(t.empty)s&&I(!1);else{const e=t.docs[0],a={...e.data(),id:e.data().id||e.id};s&&(w(a),I(!1),A(!1))}}catch(e){s&&I(!1)}finally{s&&A(!1)}})(),()=>{s=!1}},[y]);return S&&!b?s.jsx("div",{className:"container mx-auto py-10 px-4 text-center",children:"Loading receipt..."}):b?s.jsxs("div",{className:"container mx-auto py-10 px-4 print:bg-white",children:[s.jsxs(i,{variant:"ghost",className:"mb-4",onClick:()=>g(-1),children:[s.jsx(j,{className:"mr-2 h-4 w-4"})," Back to Orders"]}),F&&s.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Updating with latest data..."}),s.jsxs(m,{className:"max-w-2xl mx-auto shadow-lg print:shadow-none",children:[s.jsxs(x,{className:"bg-gray-50 print:bg-white",children:[s.jsx(o,{className:"text-xl",children:"Order Receipt"}),s.jsxs("div",{className:"flex justify-between items-center mt-2",children:[s.jsxs("span",{className:"text-sm text-gray-500",children:["Order ID: ",b.id]}),s.jsx("span",{className:"text-sm text-gray-500",children:new Date(b.date).toLocaleString()})]})]}),s.jsxs(h,{className:"pt-6",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-semibold mb-1",children:"Customer Info"}),s.jsxs("div",{className:"text-sm text-gray-700",children:[s.jsxs("div",{children:["Name: ",b.userName]}),s.jsxs("div",{children:["Email: ",b.userEmail]}),b.shippingAddress&&s.jsxs("div",{children:["Address: ",b.shippingAddress.address,", ",b.shippingAddress.locality,", ",b.shippingAddress.city,", ",b.shippingAddress.state," - ",b.shippingAddress.pincode]}),(null==(f=b.shippingAddress)?void 0:f.phone)&&s.jsxs("div",{children:["Phone: ",b.shippingAddress.phone]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-semibold mb-1",children:"Order Items"}),s.jsx("div",{className:"divide-y",children:b.items.map(e=>s.jsxs("div",{className:"flex items-center gap-4 py-2",children:[s.jsx("div",{className:"h-12 w-12 rounded bg-gray-100 overflow-hidden",children:s.jsx("img",{src:e.image,alt:e.name,className:"h-full w-full object-cover"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:e.name}),s.jsxs("div",{className:"text-xs text-gray-500",children:["Qty: ",e.quantity]})]}),s.jsxs("div",{className:"font-medium",children:["₹",(e.price*e.quantity).toFixed(2)]})]},e.id))})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-semibold mb-1",children:"Payment Summary"}),s.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Subtotal"}),s.jsxs("span",{children:["₹",(null==(u=b.subtotal)?void 0:u.toFixed(2))||b.total.toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Tax (5%)"}),s.jsxs("span",{children:["₹",(null==(N=b.tax)?void 0:N.toFixed(2))||(.05*b.total).toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Protect Fee"}),s.jsxs("span",{children:["₹",(null==(v=b.protectFee)?void 0:v.toFixed(2))||"9.00"]})]}),s.jsxs("div",{className:"flex justify-between font-semibold border-t pt-2 mt-2",children:[s.jsx("span",{children:"Total"}),s.jsxs("span",{children:["₹",b.total.toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Payment Method"}),s.jsx("span",{children:b.paymentMethod})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Payment Status"}),s.jsx("span",{children:b.paymentStatus})]})]})]}),s.jsx("div",{className:"flex justify-end gap-2 mt-6",children:s.jsxs(i,{variant:"outline",onClick:()=>{window.print()},children:[s.jsx(p,{className:"mr-2 h-4 w-4"})," Download/Print Receipt"]})})]})]})]}):s.jsx("div",{className:"container mx-auto py-10 px-4 text-center",children:"Order not found."})};export{f as default};
